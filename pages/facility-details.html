<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>تفاصيل المرفق - SABIQ</title>
  <link rel="stylesheet" href="../css/base.css">
  <link rel="stylesheet" href="../css/header.css">
  <link rel="stylesheet" href="../css/theme.css">
  <link rel="stylesheet" href="../css/facility-details.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
  
</head>
<body>
  <header class="top-bar">
    <label class="theme-toggle-switch">
      <input type="checkbox" id="theme-toggle-switch">
      <span class="slider">
        <svg class="icon sun-icon" viewBox="0 0 24 24" fill="currentColor">
          <path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.8 1.42-1.42zm10.45-1.79l-1.79 1.8 1.42 1.42 1.79-1.8-1.42-1.42zM12 4V1h-1v3h1zm0 19v-3h-1v3h1zm8-8h3v-1h-3v1zm-19 0h3v-1H1v1zm2.05 7.05l1.8-1.79-1.42-1.42-1.79 1.8 1.41 1.41zm15.9 0l1.41-1.41-1.79-1.8-1.42 1.42 1.8 1.79zM12 6a6 6 0 100 12A6 6 0 0012 6z"/>
        </svg>
        <svg class="icon moon-icon" viewBox="0 0 24 24" fill="currentColor">
          <path d="M21 12.79A9 9 0 0 1 11.21 3 7 7 0 1 0 21 12.79z"/>
        </svg>
      </span>
    </label>

    <button class="menu-toggle" id="menuToggle">☰</button>

    <aside class="side-menu" id="sideMenu">
      <br /><br /><br />
      <nav class="menu-nav">
        <ul id="menu" class="main-menu"></ul>
      </nav>
      <div class="menu-footer">
        <a href="index.html" class="logout-link">تسجيل الخروج</a>
      </div>
    </aside>

    <a href="technician-dashboard.html">
      <img src="../assets/sabiqLogoLight.png" alt="SABIQ Logo" class="logo" />
    </a>
    <h1>تفاصيل المرفق</h1>
  </header>

  <div class="facility-container">
    <!-- بطاقة معلومات المرفق -->
    <div class="facility-card">
      <div class="facility-header">
        <h2 id="facility-name">المصعد رقم 2 - الجناح الشمالي</h2>
        <span class="status-badge" id="facility-status">تحذير: يحتاج صيانة</span>
      </div>
      
      <div class="facility-meta">
        <div class="meta-item">
          <span class="meta-label">نوع المرفق:</span>
          <span class="meta-value" id="facility-type">مصعد كهربائي</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">الموقع:</span>
          <span class="meta-value" id="facility-location">الجناح الشمالي - الطابق الأرضي</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">تاريخ التركيب:</span>
          <span class="meta-value" id="installation-date">2022-03-15</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">الشركة المصنعة:</span>
          <span class="meta-value" id="manufacturer">Otis Elevator Co.</span>
        </div>
      </div>
      
      <div class="usage-progress">
        <div class="progress-header">
          <span>معدل الاستخدام اليومي</span>
          <span id="usage-percentage">85%</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" style="width: 85%;"></div>
        </div>
      </div>
    </div>

    <!-- قسم التنبؤات -->
    <section class="section">
      <h3 class="section-title">التنبؤات والتحليلات</h3>
      
      <div class="prediction-cards">
        <div class="prediction-card">
          <div class="prediction-header">
            <h4>حالة المرفق الحالية</h4>
            <span class="prediction-probability" id="failure-probability">78% احتمال عطل</span>
          </div>
          <p id="failure-prediction">عطل ميكانيكي محتمل خلال 5 أيام بناءً على أنماط الاستخدام والصيانة السابقة.</p>
        </div>
        
        <div class="prediction-card">
          <div class="prediction-header">
            <h4>أكثر الأعطال توقعاً</h4>
          </div>
          <ul class="common-issues" id="common-issues">
            <li>اهتراء الأحزمة (45%)</li>
            <li>مشاكل في المستشعرات (30%)</li>
            <li>ضغط زائد (15%)</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- قسم نصائح الصيانة -->
    <section class="section">
      <h3 class="section-title">نصائح الصيانة</h3>
      
      <div class="maintenance-advice">
        <div class="advice-header">
          <h4>الإجراءات الموصى بها</h4>
          <span class="estimated-time">الوقت المتوقع: <span id="repair-time">45 دقيقة</span></span>
        </div>
        <ol class="advice-steps" id="maintenance-advice">
          <li>تفقد حزام المحرك الرئيسي للتأكد من عدم وجود اهتراء</li>
          <li>فحص نظام الفرامل والتأكد من كفاءته</li>
          <li>تزيين القضبان المتحركة لضمان سلاسة الحركة</li>
          <li>اختبار مستشعرات الأبواب والأرضية</li>
        </ol>
      </div>
    </section>

    <!-- قسم الرسوم البيانية -->
    <section class="section">
      <h3 class="section-title">مؤشرات الأداء</h3>
      
      <div class="chart-container">
        <div class="chart-wrapper">
          <canvas id="usage-chart"></canvas>
          <p class="chart-title">استخدام المرفق خلال 30 يومًا</p>
        </div>
        <div class="chart-wrapper">
          <canvas id="failure-chart"></canvas>
          <p class="chart-title">معدلات الأعطال السابقة</p>
        </div>
      </div>
    </section>

    <!-- قسم سجل الصيانة -->
    <section class="section">
      <h3 class="section-title">سجل الصيانة</h3>
      
      <div class="history-container">
        <table class="maintenance-history">
          <thead>
            <tr>
              <th>التاريخ</th>
              <th>نوع العطل</th>
              <th>سبب المشكلة</th>
              <th>الإجراء المتخذ</th>
              <th>الفني</th>
            </tr>
          </thead>
          <tbody id="maintenance-history">
            <tr>
              <td>2023-11-10</td>
              <td>ميكانيكي</td>
              <td>اهتراء حزام المحرك</td>
              <td>استبدال الحزام</td>
              <td>خالد أحمد</td>
            </tr>
            <tr>
              <td>2023-09-05</td>
              <td>كهربائي</td>
              <td>مشاكل في لوحة التحكم</td>
              <td>إعادة ضبط الإعدادات</td>
              <td>أحمد محمد</td>
            </tr>
            <tr>
              <td>2023-07-22</td>
              <td>ميكانيكي</td>
              <td>ضغط زائد على النظام</td>
              <td>تعديل إعدادات الحمل</td>
              <td>علي محمود</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- أزرار الإجراءات -->
  <div class="action-buttons">
  <button class="btn btn-primary" id="start-maintenance-btn">
    <i class="fas fa-tools"></i> بدء مهمة الصيانة
  </button>
  <button class="btn btn-secondary" id="request-parts-btn">
    <i class="fas fa-box-open"></i> طلب قطع غيار
  </button>
  <button class="btn btn-danger" id="report-failure-btn">
    <i class="fas fa-exclamation-triangle"></i> إبلاغ عن عطل
  </button>
</div>
  <button class="qr-btn" id="qrButton" title="مسح QR Code">
      <svg viewBox="0 0 24 24">
        <path d="M3,11H5V13H3V11M11,5H13V9H11V5M9,11H13V15H11V13H9V11M15,11H17V13H19V11H21V13H19V15H21V19H19V21H17V19H13V21H11V17H15V15H17V13H15V11M19,19V15H17V19H19M15,3H21V9H15V3M17,5V7H19V5H17M3,3H9V9H3V3M5,5V7H7V5H5M3,15H5V17H3V15M7,15H9V17H7V15Z"/>
      </svg>
    </button>
  </div>

  <footer class="page-footer">
    &copy; 2025 SABIQ. جميع الحقوق محفوظة.
  </footer>

  <!-- السكريبتات -->
  <script src="../js/header.js"></script>
  <script src="../js/theme.js"></script>
  <script src="../js/menu.js" defer></script>
  <script src="../js/facility-details.js" defer></script>
</body>
</html>