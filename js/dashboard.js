fetch('http://localhost:3000/facilities')
  .then(response => response.json())
  .then(data => {
    const grid = document.getElementById('facilityGrid');
    data.forEach(facility => {
      const card = document.createElement('div');
      card.className = 'facility-card';

      let statusText = '';
      if (facility.status === 'danger') {
        statusText = '🔴 مُعطل';
      } else if (facility.status === 'good') {
        statusText = '✅ شغال';
      } else {
        statusText = facility.status;
      }

      let predictionText = '';
      if (facility.model_prediction === '1' && facility.status !== 'danger') {
        predictionText = 'يتوقع حدوث عطل قريب';
      } else if (facility.model_prediction === '0' && facility.status !== 'danger') {
        predictionText = 'لا يتوقع حدوث عطل قريب';
      } else {
        predictionText = 'التنبؤ غير متوفر';
      }

      card.innerHTML = `
        <h3>${facility.name}</h3>
        
        <div class="facility-stats">
          <div class="stat">
            <span class="stat-label">الحرارة</span>
            <span class="stat-value">${facility.temperature}</span>
          </div>
          <div class="stat">
            <span class="stat-label">الاهتزاز</span>
            <span class="stat-value">${facility.vibration}</span>
          </div>
          <div class="stat">
            <span class="stat-label">الضغط</span>
            <span class="stat-value">${facility.pressure}</span>
          </div>
          <div class="stat">
            <span class="stat-label">الرطوبة</span>
            <span class="stat-value">${facility.humidity}</span>
          </div>
          <div class="stat">
            <span class="stat-label">حمل الموتور</span>
            <span class="stat-value">${facility.motor_load}</span>
          </div>
          <div class="stat prediction">
            <span class="stat-label">
              <svg class="ai-icon" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 256 256" xml:space="preserve">
<g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">
	<path d="M 85.755 24.781 c -0.842 0 -1.615 -0.485 -2.02 -1.267 c -0.12 -0.231 -0.246 -0.462 -0.378 -0.689 c -0.132 -0.229 -0.269 -0.454 -0.41 -0.674 c -0.474 -0.74 -0.506 -1.653 -0.086 -2.382 c 0.567 -0.982 0.718 -2.126 0.425 -3.221 c -0.294 -1.096 -0.996 -2.011 -1.979 -2.578 l -4.299 -2.482 c -0.982 -0.567 -2.125 -0.717 -3.222 -0.423 c -1.071 0.287 -1.964 0.97 -2.534 1.917 c -5.554 -5.786 -13.256 -8.807 -21.331 -8.298 c -9.311 0.585 -17.383 5.911 -21.807 13.586 h -4.568 l -5.506 -6.971 c -0.189 -0.24 -0.479 -0.38 -0.785 -0.38 h -4.25 c -0.484 -3.135 -3.192 -5.545 -6.461 -5.545 C 2.937 5.374 0 8.31 0 11.919 s 2.937 6.546 6.546 6.546 c 3.269 0 5.977 -2.411 6.461 -5.546 h 3.765 l 5.506 6.971 c 0.189 0.24 0.479 0.38 0.785 0.38 h 4.007 c -1.382 2.938 -2.252 6.162 -2.492 9.555 c -0.016 0.228 -0.017 0.455 -0.027 0.683 H 13.007 c -0.484 -3.135 -3.192 -5.546 -6.461 -5.546 C 2.937 24.962 0 27.898 0 31.508 s 2.937 6.545 6.546 6.545 c 3.269 0 5.977 -2.41 6.461 -5.545 h 11.526 c 0.098 3.565 0.88 7.039 2.289 10.238 h -3.758 c -0.306 0 -0.595 0.14 -0.785 0.38 l -5.506 6.971 h -3.765 c -0.484 -3.135 -3.192 -5.546 -6.461 -5.546 C 2.937 44.55 0 47.487 0 51.097 c 0 3.608 2.937 6.545 6.546 6.545 c 3.268 0 5.977 -2.411 6.461 -5.545 h 4.25 c 0.306 0 0.595 -0.14 0.785 -0.38 l 5.506 -6.971 h 4.267 c 1.728 3.186 4.089 6.042 7.013 8.357 c 3.514 2.78 5.529 6.858 5.529 11.189 v 0.622 c 0 0.001 0 0.002 0 0.002 v 6.992 c 0 1.582 1.092 2.903 2.559 3.277 v 4.853 c 0 2.94 2.393 5.332 5.333 5.332 H 55.1 c 2.94 0 5.333 -2.392 5.333 -5.332 v -4.854 c 1.466 -0.375 2.559 -1.696 2.559 -3.277 v -6.992 V 64.29 c 0 -4.315 1.995 -8.441 5.338 -11.038 c 1.111 -0.863 2.167 -1.835 3.157 -2.894 c 0.568 0.773 1.361 1.34 2.301 1.593 c 0.366 0.099 0.737 0.146 1.106 0.146 c 0.735 0 1.462 -0.192 2.115 -0.57 l 4.299 -2.482 c 0.981 -0.566 1.685 -1.482 1.978 -2.578 c 0.294 -1.095 0.144 -2.239 -0.424 -3.221 c -0.421 -0.729 -0.399 -1.623 0.057 -2.331 c 0.303 -0.47 0.587 -0.962 0.843 -1.46 c 0.387 -0.752 1.15 -1.22 1.994 -1.22 c 2.341 0 4.245 -1.904 4.245 -4.245 v -4.964 C 90 26.685 88.096 24.781 85.755 24.781 z M 6.546 16.465 C 4.039 16.465 2 14.426 2 11.919 c 0 -2.506 2.039 -4.545 4.546 -4.545 c 2.506 0 4.545 2.039 4.545 4.545 C 11.091 14.426 9.052 16.465 6.546 16.465 z M 6.546 36.053 C 4.039 36.053 2 34.014 2 31.508 c 0 -2.507 2.039 -4.546 4.546 -4.546 c 2.506 0 4.545 2.039 4.545 4.546 C 11.091 34.014 9.052 36.053 6.546 36.053 z M 6.546 55.642 C 4.039 55.642 2 53.603 2 51.097 c 0 -2.507 2.039 -4.546 4.546 -4.546 c 2.506 0 4.545 2.039 4.545 4.546 C 11.091 53.603 9.052 55.642 6.546 55.642 z M 50.047 6.68 c 7.367 -0.462 14.411 2.238 19.538 7.444 c -0.141 0.019 -0.281 0.044 -0.429 0.036 c -0.554 -0.026 -1.12 -0.027 -1.686 0 c -0.861 0.04 -1.627 -0.388 -2.047 -1.116 c -1.172 -2.027 -3.772 -2.726 -5.8 -1.554 l -4.299 2.482 c -0.982 0.567 -1.685 1.483 -1.978 2.578 c -0.153 0.571 -0.179 1.154 -0.095 1.721 H 30.48 C 34.684 11.705 41.836 7.195 50.047 6.68 z M 26.573 29.965 c 0.245 -3.477 1.226 -6.749 2.751 -9.696 h 24.651 c 0.178 0.613 0.096 1.278 -0.261 1.832 c -0.302 0.469 -0.585 0.96 -0.843 1.459 c -0.387 0.752 -1.15 1.219 -1.993 1.219 c -2.342 0 -4.246 1.905 -4.246 4.246 v 1.482 H 26.552 C 26.561 30.327 26.56 30.147 26.573 29.965 z M 26.532 32.508 h 20.1 v 1.482 c 0 2.341 1.904 4.245 4.246 4.245 c 0.841 0 1.615 0.485 2.02 1.266 c 0.12 0.232 0.245 0.462 0.378 0.693 c 0.133 0.228 0.269 0.451 0.409 0.672 c 0.119 0.185 0.21 0.38 0.273 0.581 s 0.099 0.407 0.106 0.613 c 0.008 0.233 -0.029 0.462 -0.092 0.686 H 29.036 C 27.505 39.577 26.639 36.095 26.532 32.508 z M 58.433 80.039 c 0 1.837 -1.495 3.332 -3.333 3.332 h -6.852 c -1.838 0 -3.333 -1.495 -3.333 -3.332 v -4.737 h 13.518 V 80.039 z M 60.991 71.908 c 0 0.769 -0.625 1.394 -1.394 1.394 h -0.165 H 43.915 h -0.166 c -0.768 0 -1.393 -0.625 -1.393 -1.394 v -5.992 h 18.635 V 71.908 z M 67.103 51.672 c -3.729 2.897 -5.994 7.452 -6.107 12.244 H 42.352 c -0.113 -4.805 -2.389 -9.3 -6.283 -12.382 c -2.415 -1.911 -4.419 -4.219 -5.961 -6.789 h 23.144 c -0.044 0.295 -0.062 0.594 -0.042 0.894 c 0.018 0.277 0.064 0.554 0.138 0.828 c 0.293 1.095 0.996 2.011 1.978 2.577 l 4.299 2.482 c 0.512 0.295 1.059 0.47 1.611 0.536 c 1.639 0.197 3.314 -0.575 4.19 -2.092 c 0.422 -0.73 1.213 -1.164 2.053 -1.115 c 0.57 0.028 1.137 0.027 1.684 0 c 0.185 -0.009 0.362 0.014 0.536 0.047 c 0.07 0.014 0.138 0.033 0.206 0.053 c 0.041 0.012 0.078 0.031 0.118 0.045 C 69.106 49.98 68.128 50.875 67.103 51.672 z M 88 33.99 c 0 1.238 -1.008 2.245 -2.247 2.245 c -1.595 0 -3.04 0.883 -3.771 2.306 c -0.227 0.441 -0.477 0.875 -0.745 1.292 c -0.863 1.341 -0.904 3.032 -0.107 4.414 c 0.3 0.52 0.38 1.125 0.225 1.704 s -0.526 1.063 -1.046 1.363 l -4.299 2.482 c -0.52 0.301 -1.125 0.379 -1.703 0.225 c -0.58 -0.155 -1.064 -0.527 -1.364 -1.048 c -0.334 -0.58 -0.793 -1.049 -1.327 -1.402 c -0.037 -0.025 -0.075 -0.048 -0.113 -0.072 c -0.22 -0.136 -0.449 -0.258 -0.691 -0.351 c -0.016 -0.006 -0.032 -0.012 -0.048 -0.018 c -0.222 -0.083 -0.454 -0.141 -0.69 -0.186 c -0.085 -0.016 -0.168 -0.03 -0.254 -0.041 c -0.247 -0.033 -0.497 -0.052 -0.753 -0.043 c 0 0 -0.001 0 -0.001 0 s -0.001 0 -0.001 0 c -0.485 0.025 -0.986 0.025 -1.489 0 c -1.602 -0.061 -3.085 0.731 -3.883 2.114 c -0.077 0.134 -0.166 0.256 -0.265 0.367 c -0.006 0.007 -0.013 0.011 -0.019 0.018 c -0.695 0.764 -1.852 0.973 -2.783 0.437 l -4.299 -2.482 c -0.52 -0.3 -0.891 -0.783 -1.046 -1.363 c -0.039 -0.145 -0.063 -0.291 -0.073 -0.438 c -0.029 -0.439 0.072 -0.876 0.297 -1.266 c 0.02 -0.034 0.033 -0.071 0.051 -0.106 c 0.001 -0.003 0.003 -0.006 0.005 -0.009 c 0.144 -0.268 0.256 -0.547 0.338 -0.833 c 0.12 -0.419 0.181 -0.852 0.167 -1.286 c -0.023 -0.771 -0.256 -1.542 -0.696 -2.228 c -0.125 -0.194 -0.245 -0.394 -0.361 -0.593 c -0.116 -0.203 -0.228 -0.406 -0.333 -0.611 c -0.748 -1.448 -2.203 -2.347 -3.796 -2.347 c -1.238 0 -2.245 -1.007 -2.245 -2.245 v -4.964 c 0 -0.826 0.453 -1.54 1.118 -1.931 c 0.333 -0.195 0.716 -0.315 1.129 -0.315 c 1.196 0 2.307 -0.497 3.097 -1.345 c 0.263 -0.283 0.49 -0.604 0.673 -0.959 c 0.229 -0.442 0.479 -0.877 0.746 -1.292 c 0.841 -1.306 0.896 -2.94 0.164 -4.3 c -0.001 -0.003 -0.003 -0.006 -0.005 -0.01 c -0.019 -0.034 -0.032 -0.071 -0.051 -0.105 c -0.3 -0.52 -0.38 -1.125 -0.225 -1.704 c 0.155 -0.58 0.526 -1.063 1.046 -1.363 l 4.299 -2.482 c 0.158 -0.091 0.325 -0.154 0.493 -0.204 c 0.055 -0.016 0.11 -0.025 0.165 -0.037 c 0.119 -0.025 0.238 -0.041 0.358 -0.046 c 0.057 -0.003 0.114 -0.006 0.171 -0.004 c 0.155 0.005 0.309 0.023 0.459 0.059 c 0.018 0.004 0.036 0.004 0.054 0.009 c 0.166 0.044 0.324 0.112 0.476 0.193 c 0.045 0.024 0.087 0.053 0.131 0.08 c 0.11 0.068 0.214 0.147 0.312 0.234 c 0.039 0.035 0.079 0.069 0.115 0.106 c 0.125 0.129 0.241 0.27 0.334 0.432 c 0.797 1.381 2.275 2.19 3.875 2.113 c 0.498 -0.025 1.001 -0.023 1.491 0 c 0.244 0.012 0.484 -0.004 0.721 -0.032 c 0.036 -0.004 0.07 -0.011 0.106 -0.017 c 0.213 -0.031 0.421 -0.078 0.624 -0.14 c 0.025 -0.008 0.05 -0.014 0.074 -0.023 c 0.471 -0.153 0.91 -0.386 1.3 -0.691 c 0.002 -0.001 0.004 -0.002 0.006 -0.004 c 0.001 -0.001 0.002 -0.003 0.003 -0.004 c 0.414 -0.327 0.775 -0.729 1.049 -1.205 c 0.3 -0.519 0.783 -0.891 1.363 -1.046 c 0.58 -0.156 1.185 -0.075 1.703 0.225 l 4.299 2.482 c 0.52 0.3 0.892 0.784 1.046 1.363 c 0.155 0.58 0.075 1.185 -0.225 1.705 c -0.795 1.379 -0.743 3.088 0.135 4.46 c 0.124 0.194 0.245 0.392 0.361 0.594 c 0.116 0.202 0.229 0.406 0.334 0.609 c 0.748 1.448 2.203 2.347 3.796 2.347 c 1.238 0 2.245 1.007 2.245 2.245 V 33.99 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(0,0,0); fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>
	<path d="M 64.412 23.588 H 61.79 c -2.197 0 -3.984 1.787 -3.984 3.984 v 10.854 c 0 0.552 0.447 1 1 1 s 1 -0.448 1 -1 v -5.919 h 6.59 v 5.919 c 0 0.552 0.447 1 1 1 s 1 -0.448 1 -1 V 27.572 C 68.396 25.375 66.608 23.588 64.412 23.588 z M 59.806 30.508 v -2.936 c 0 -1.094 0.891 -1.984 1.984 -1.984 h 2.622 c 1.094 0 1.983 0.89 1.983 1.984 v 2.936 H 59.806 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(0,0,0); fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>
	<path d="M 77.827 25.588 c 0.553 0 1 -0.448 1 -1 s -0.447 -1 -1 -1 h -5.674 c -0.553 0 -1 0.448 -1 1 s 0.447 1 1 1 h 1.837 v 11.838 h -1.837 c -0.553 0 -1 0.448 -1 1 s 0.447 1 1 1 h 5.674 c 0.553 0 1 -0.448 1 -1 s -0.447 -1 -1 -1 H 75.99 V 25.588 H 77.827 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(0,0,0); fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>
</g>
</svg>
              تنبؤ النظام:
            </span>
            <span class="stat-value">${predictionText}</span>
          </div>
        </div>

        <div class="card-actions">
          <span class="status ${facility.status}">${statusText}</span>
          <a href="details.html?id=${facility.id}" class="btn">عرض التفاصيل</a>
        </div>
      `;

      grid.appendChild(card);
    });
  })
  .catch(err => {
    console.error("خطأ في جلب بيانات المرافق:", err);
  });